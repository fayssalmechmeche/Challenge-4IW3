{% extends 'base.html.twig' %}

{% block title %}Nouveau Devis
{% endblock %}

{% block body  %}
	<nav class="flex justify-between w-full items-center py-3 px-5  bg-nav-bar-black ">
		<a class="transition-all duration-300 text-white cursor-pointer hover:text-red-500 flex items-center gap-1" href="{{ path('app_devis_index') }}">
			<span class="material-symbols-outlined">
				arrow_circle_left</span>
			Retour à la liste</a>
		<button id="dl-pdf" class="bg-white py-2 px-4 cursor-pointer rounded-md transition-all duration-300 text-base font-bold hover:bg-lime-500 flex items-center gap-1">
			<span class="material-symbols-outlined">
				download
			</span>Télécharger le devis</button>
	</nav>
	<div class="Generator font-roboto w-A4w bg-white my-5 mx-auto p-5 border border-solid border-gray-300 shadow-md">
		<div class="top h-auto w-full flex justify-between items-start">
			<div class="society w-1/2 flex justify-center items-start flex-col">
				<div class="logoName">
					<img class="w-36 h-36 border border-solid border-gray-300" src="{{ asset('images/navbar/Main Logo.svg') }}" alt="logo"/>
				</div>
				<div class="society-info mt-15px p-5px">
					<h2 class="text-lg mb-3 font-semibold">Le nom de la société</h2>
					<p class="text-15px">Mail :
						{{ userEmail }}</p>
				</div>
			</div>

			<div class="top-r w-1/2">
				<div class="devis w-full bg-the-grey-2 p-15px border border-solid border-gray-300 rounded-10px shadow-md flex justify-between items-start flex-col">
					<h1 class="text-2xl font-semibold">Devis</h1>
					<div class="devis-info">
						<p class="text-15px leading-none my-1">Numéro de devis:
							{{ devi.devisNumber }}</p>
						<p class="text-15px leading-none my-1">Date:
							{{ devi.createdAt|date('Y-m-d') }}</p>
						<p class="text-15px leading-none my-1">
							Validité du devis: 3 Mois
						</p>
					</div>
				</div>
				<div class="client mt-3 px-5px">
					<h2 class="text-lg font-semibold">Information Client</h2>
					<div class="client-info mt-2" id="client-info">
						<div class="client-info mt-2">
							{% if devi.customer.nameSociety is not empty %}
								<p class="text-15px">Société:
									{{ devi.customer.nameSociety }}</p>
							{% else %}
								<p class="text-15px">Nom:
									{{ devi.customer.name }}
									{{ devi.customer.lastName }}</p>
							{% endif %}
							<p class="text-15px">Adresse:
								{{ devi.customer.streetNumber }}
								{{ devi.customer.streetName }}</p>
							<p class="text-15px">Code Postal:
								{{ devi.customer.postalCode }}</p>
							<p class="text-15px">Ville:
								{{ devi.customer.city }}</p>
							<p class="text-15px">Téléphone:
								{{ devi.customer.phoneNumber }}</p>
							<p class="text-15px">Mail:
								{{ devi.customer.email }}</p>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="table-container w-full mt-7 flex justify-start items-center flex-col">
			<div class="objet w-full flex justify-start items-center self-center mb-5 ml-5px">
				<h2 class="text-lg font-semibold">Objet:</h2>
				<p id="commande-title" class="ml-1 text-lg">
					Prise en charge des repas d'un marriage
				</p>
			</div>

			<div id="devisProductsData" class="hidden" data-products="{{ products|json_encode }}"></div>
			<div id="devisFormulasData" class="hidden" data-formulas="{{ formulas|json_encode }}"></div>

			<div id="wrapper" class="h-fit"></div>


            <div class="top-r w-1/2">
                <div
                        class="devis w-full bg-the-grey-2 p-15px border border-solid border-gray-300 rounded-10px shadow-md flex justify-between items-start flex-col"
                >
                    <h1 class="text-2xl font-semibold">Devis</h1>
                    <div class="devis-info">
                        <p class="text-15px leading-none my-1">Numéro de devis: {{ devi.devisNumber }}</p>
                        <p class="text-15px leading-none my-1">Date: {{ devi.createdAt|date('Y-m-d') }}</p>
                        <p class="text-15px leading-none my-1">
                            Validité du devis: 3 Mois
                        </p>
                    </div>
                </div>
                <div class="client mt-3 px-5px">
                    <h2 class="text-lg font-semibold">Information Client</h2>
                    <div class="client-info mt-2" id="client-info">
                        <div class="client-info mt-2">
                            {% if devi.customer.nameSociety is not empty %}
                                <p class="text-15px">Société: {{ devi.customer.nameSociety }}</p>
                            {% else %}
                                <p class="text-15px">Nom: {{ devi.customer.name }} {{ devi.customer.lastName }}</p>
                            {% endif %}
                            <p class="text-15px">Adresse: {{ devi.customer.streetNumber }} {{ devi.customer.streetName }}</p>
                            <p class="text-15px">Code Postal: {{ devi.customer.postalCode }}</p>
                            <p class="text-15px">Ville: {{ devi.customer.city }}</p>
                            <p class="text-15px">Téléphone: {{ devi.customer.phoneNumber }}</p>
                            <p class="text-15px">Mail: {{ devi.customer.email }}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div
                class="table-container w-full mt-7 flex justify-start items-center flex-col"
        >
            <div
                    class="objet w-full flex justify-start items-center self-center mb-5 ml-5px"
            >
                <h2 class="text-lg font-semibold">Objet:</h2>
                <p id="commande-title" class="ml-1 text-lg">
                    {{ devi.subject }}
                </p>
            </div>
  {% include 'components/dark_mode.html.twig' with {'topHeight': 'top-20'} %}

{% endblock %}

{% block javascripts %}
	{{ parent() }}
	<script src="{{ asset('js/pdfGenerator.js') }}"></script>
	<script src="{{ asset('js/devisShow.js') }}" type="module"></script>
{% endblock %}
